# 프로젝트 구조

정리된 최종 프로젝트 구조입니다.

---

## 📁 프로젝트 루트

```
Slack_auto_attendance_check/
├── 📄 핵심 실행 파일
│   ├── app_flask.py                    # ⭐ 메인 서버 (Flask 웹 UI + 자동 스케줄러)
│   ├── 실행.bat                        # 로컬 실행용 배치 파일
│   └── requirements.txt                # Python 패키지 의존성
│
├── 📄 EXE 빌드 관련
│   ├── build_exe.py                    # PyInstaller 빌드 스크립트
│   ├── attendance_app.spec             # PyInstaller 설정 파일
│   ├── convert_icon.py                 # PNG → ICO 변환 스크립트
│   ├── 빌드.bat                        # 일반 빌드
│   └── 아이콘빌드.bat                  # 아이콘 포함 빌드
│
├── 📄 문서
│   ├── README.md                       # 프로젝트 소개 및 빠른 시작 가이드
│   ├── CLAUDE.md                       # 프로젝트 계획서 및 진행 상황
│   ├── DEPLOYMENT.md                   # ⭐ 서버 배포 가이드
│   ├── SETUP_GUIDE.md                  # ⭐ 워크스페이스 설정 가이드 (슬랙/구글 시트)
│   ├── UPGRADE_RECOMMENDATIONS.md      # 추가 기능 제안
│   └── PROJECT_STRUCTURE.md            # 이 파일 (프로젝트 구조 설명)
│
├── 📂 소스 코드
│   └── src/
│       ├── __init__.py
│       ├── workspace_manager.py        # 워크스페이스 관리
│       ├── slack_handler.py            # 슬랙 API 처리
│       ├── sheets_handler.py           # 구글 시트 API 처리
│       ├── parser.py                   # 출석 댓글 파싱
│       └── utils.py                    # 유틸리티 함수
│
├── 📂 웹 UI
│   ├── templates/
│   │   └── index.html                  # Flask 웹 UI HTML
│   └── static/
│       ├── css/
│       └── js/
│
├── 📂 워크스페이스 설정
│   └── workspaces/
│       ├── README.md
│       ├── 테스트/
│       │   ├── workspace.json          # 워크스페이스 설정 (슬랙, 구글 시트, 스케줄)
│       │   └── credentials.json        # 구글 서비스 계정 키
│       ├── 서울대/
│       │   ├── workspace.json
│       │   └── credentials.json
│       └── ... (최대 6개 학교)
│
├── 📂 아이콘 (EXE용)
│   └── img/
│       ├── Auto.png                    # 원본 PNG 이미지
│       └── Auto.ico                    # EXE 아이콘 (자동 생성)
│
├── 📂 빌드 결과 (Git 제외)
│   ├── build/                          # PyInstaller 빌드 임시 파일
│   └── dist/
│       └── 슬랙출석체크/
│           └── 슬랙출석체크.exe        # 최종 실행 파일
│
├── 📂 로그 (Git 제외)
│   └── logs/
│       └── *.log                       # 실행 로그
│
└── 📄 Git 설정
    ├── .gitignore                      # Git 제외 파일 목록
    └── .git/                           # Git 저장소
```

---

## 🎯 주요 파일 설명

### 1. 실행 관련

| 파일 | 용도 | 실행 방법 |
|------|------|----------|
| [app_flask.py](app_flask.py) | 메인 서버 (Flask + 스케줄러) | `python app_flask.py` |
| [실행.bat](실행.bat) | 로컬 실행 (conda 자동 활성화) | 더블클릭 |
| dist/슬랙출석체크.exe | EXE 실행 파일 | 더블클릭 |

### 2. 빌드 관련

| 파일 | 용도 |
|------|------|
| [build_exe.py](build_exe.py) | PyInstaller 빌드 실행 스크립트 |
| [attendance_app.spec](attendance_app.spec) | PyInstaller 설정 (hiddenimports, icon 등) |
| [convert_icon.py](convert_icon.py) | PNG 이미지 → ICO 아이콘 변환 |
| [빌드.bat](빌드.bat) | 일반 빌드 (아이콘 없음) |
| [아이콘빌드.bat](아이콘빌드.bat) | 아이콘 포함 빌드 |

### 3. 문서

| 문서 | 내용 |
|------|------|
| [README.md](README.md) | 프로젝트 소개, 빠른 시작 가이드 |
| [CLAUDE.md](CLAUDE.md) | 프로젝트 전체 계획서, TASK 목록, 진행 상황 |
| [DEPLOYMENT.md](DEPLOYMENT.md) | **서버 배포 가이드** (로컬 설정 → 서버 전송 → 실행) |
| [SETUP_GUIDE.md](SETUP_GUIDE.md) | **워크스페이스 설정 가이드** (슬랙 API, 구글 시트 설정) |
| [UPGRADE_RECOMMENDATIONS.md](UPGRADE_RECOMMENDATIONS.md) | 추가 기능 제안 (통계, 히스토리, 엑셀 다운로드 등) |
| [PROJECT_STRUCTURE.md](PROJECT_STRUCTURE.md) | 이 문서 (프로젝트 구조) |

### 4. 소스 코드 (src/)

| 파일 | 기능 |
|------|------|
| [workspace_manager.py](src/workspace_manager.py) | 워크스페이스 로드, 저장, 관리 |
| [slack_handler.py](src/slack_handler.py) | 슬랙 API (메시지 읽기, 댓글 수집, DM 전송) |
| [sheets_handler.py](src/sheets_handler.py) | 구글 시트 API (명단 읽기, 출석 업데이트) |
| [parser.py](src/parser.py) | 출석 댓글 파싱 ("이름/출석" 패턴 인식) |
| [utils.py](src/utils.py) | 유틸리티 함수 (URL 파싱, 열 변환 등) |

---

## 🚀 사용 시나리오별 가이드

### 시나리오 1: 로컬에서 수동 실행 (웹 UI)

```bash
# 방법 A: 배치 파일
실행.bat 더블클릭

# 방법 B: EXE 파일
dist\슬랙출석체크\슬랙출석체크.exe 더블클릭

# 방법 C: Python 직접 실행
conda activate auto
python app_flask.py
```

→ 웹 브라우저 자동 열림 (http://127.0.0.1:5000)
→ 워크스페이스 선택 → 출석체크 실행

### 시나리오 2: 로컬에서 스케줄 설정

```bash
# 1. 프로그램 실행
실행.bat

# 2. 웹 UI에서 "⏰ 자동 실행 스케줄" 탭 클릭

# 3. 스케줄 설정
- 출석 스레드 생성: 토요일 17:00
- 출석 집계: 토요일 18:00
- 출석 기입 열: K

# 4. "스케줄 저장" 버튼 클릭
→ workspaces/[워크스페이스]/workspace.json에 저장됨

# 5. 프로그램 종료 (Ctrl+C)
```

### 시나리오 3: 서버에 배포 (완전 자동화)

```bash
# 1. workspaces/ 폴더를 서버로 전송
scp -r workspaces/ user@server:/path/to/project/

# 2. 서버에서 실행
python app_flask.py

# 3. 스케줄 시간에 자동 실행됨!
토 17:00 → 슬랙에 출석 스레드 자동 생성
토 18:00 → 댓글 수집 → 구글시트 업데이트 → 알림
```

자세한 내용은 [DEPLOYMENT.md](DEPLOYMENT.md) 참고

### 시나리오 4: 새 워크스페이스 추가

```bash
# 1. 슬랙 설정 (Bot Token, 채널 ID)
# 2. 구글 시트 설정 (서비스 계정, JSON 키)
# 3. workspaces/[학교명]/ 폴더 생성
# 4. workspace.json, credentials.json 작성
# 5. 웹 UI에서 스케줄 설정
```

자세한 내용은 [SETUP_GUIDE.md](SETUP_GUIDE.md) 참고

### 시나리오 5: EXE 빌드 (배포용)

```bash
# 방법 A: 아이콘 포함 빌드 (추천)
아이콘빌드.bat 더블클릭

# 방법 B: 일반 빌드
빌드.bat 더블클릭

# 결과
dist\슬랙출석체크\슬랙출석체크.exe 생성
```

---

## 📝 파일 역할 요약

### ✅ 서버 배포 시 필요한 파일

```
app_flask.py              # 메인 서버
requirements.txt          # 패키지 목록
src/                      # 소스 코드
templates/                # 웹 UI
static/                   # CSS/JS
workspaces/               # 워크스페이스 설정
```

### ❌ 서버 배포 시 불필요한 파일

```
build/                    # 빌드 임시 파일 (로컬 전용)
dist/                     # EXE 파일 (로컬 전용)
img/                      # 아이콘 (EXE 전용)
*.bat                     # 배치 파일 (Windows 전용)
build_exe.py              # 빌드 스크립트
attendance_app.spec       # PyInstaller 설정
convert_icon.py           # 아이콘 변환
```

---

## 🔒 보안 주의사항

### Git에 절대 커밋하면 안 되는 파일:

- `workspaces/*/credentials.json` (구글 서비스 계정 키)
- `workspaces/*/workspace.json` (슬랙 Bot Token 포함)
- `build/`, `dist/` (빌드 결과물)
- `logs/*.log` (실행 로그)

→ 이미 [.gitignore](.gitignore)에 추가되어 있음 ✅

---

## 📊 디스크 사용량

```
프로젝트 전체:    ~350 MB
├── dist/         ~260 MB (EXE 파일, 로컬 전용)
├── build/        ~40 MB  (빌드 임시 파일, 로컬 전용)
├── 소스 코드     ~5 MB
└── 문서          ~50 KB
```

**서버 배포 시 필요한 크기: 약 5 MB**

---

문제가 있으면 언제든지 물어보세요! 🎉
